# üöõ PDPTW Visualizer - Refactored Architecture

> **Modern web-based visualization tool for Pickup and Delivery Problem with Time Windows (PDPTW)**

![Architecture](https://img.shields.io/badge/Architecture-Frontend%2FBackend%20Separated-brightgreen)
![Backend](https://img.shields.io/badge/Backend-Python%20Flask-blue)
![Frontend](https://img.shields.io/badge/Frontend-Vanilla%20JavaScript-yellow)
![API](https://img.shields.io/badge/API-RESTful-orange)

## üèóÔ∏è **Ki·∫øn tr√∫c m·ªõi (Refactored)**

### **üìã T·ªïng quan:**
D·ª± √°n ƒë√£ ƒë∆∞·ª£c **refactor ho√†n to√†n** ƒë·ªÉ t√°ch bi·ªát Frontend v√† Backend, t·∫°o ra m·ªôt ki·∫øn tr√∫c hi·ªán ƒë·∫°i v√† d·ªÖ b·∫£o tr√¨.

```
PDPTW Visualizer
‚îú‚îÄ‚îÄ üñ•Ô∏è  Frontend (Client-side)
‚îÇ   ‚îú‚îÄ‚îÄ Pure HTML/CSS/JavaScript
‚îÇ   ‚îú‚îÄ‚îÄ Interactive map visualization  
‚îÇ   ‚îú‚îÄ‚îÄ Real-time API communication
‚îÇ   ‚îî‚îÄ‚îÄ Responsive user interface
‚îÇ
‚îú‚îÄ‚îÄ ‚öôÔ∏è  Backend (Server-side)
‚îÇ   ‚îú‚îÄ‚îÄ Python Flask REST API
‚îÇ   ‚îú‚îÄ‚îÄ PDPTW algorithm execution
‚îÇ   ‚îú‚îÄ‚îÄ File processing & validation
‚îÇ   ‚îî‚îÄ‚îÄ Data management
‚îÇ
‚îî‚îÄ‚îÄ üîó Communication via REST API
```

## üìÅ **C·∫•u tr√∫c d·ª± √°n:**

```
PDPTW/
‚îú‚îÄ‚îÄ üéØ run.sh / run.bat          # Quick start scripts
‚îú‚îÄ‚îÄ üìÑ README.md                 # This file
‚îú‚îÄ‚îÄ 
‚îú‚îÄ‚îÄ üñ•Ô∏è frontend/                 # Client-side application
‚îÇ   ‚îú‚îÄ‚îÄ index.html               # Main application page
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.js              # Backend API communication
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.js              # Main application logic
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ styles.css          # Custom styling
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ structures.js       # Data structures
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reader.js           # File parsing
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mapper.js           # Map visualization
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ timeline.js         # Timeline features
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ guide.js            # User guide
‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îÇ
‚îú‚îÄ‚îÄ ‚öôÔ∏è backend/                  # Server-side API
‚îÇ   ‚îú‚îÄ‚îÄ app.py                  # Flask application
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt        # Python dependencies
‚îÇ   ‚îú‚îÄ‚îÄ uploads/                # Uploaded files
‚îÇ   ‚îú‚îÄ‚îÄ results/                # Generated results
‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îÇ
‚îú‚îÄ‚îÄ üîß RELEASE/                  # Algorithm executables
‚îÇ   ‚îú‚îÄ‚îÄ PDPTW_ACO.exe
‚îÇ   ‚îú‚îÄ‚îÄ PDPTW_GREEDY_INSERTION.exe
‚îÇ   ‚îú‚îÄ‚îÄ PDPTW_HYBRID_ACO_GREEDY_V3.exe
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ üìä dataset/                  # Test instances and solutions
‚îÇ   ‚îú‚îÄ‚îÄ Instances/
‚îÇ   ‚îî‚îÄ‚îÄ Solutions/
‚îÇ
‚îú‚îÄ‚îÄ ‚úÖ validator/                # Solution validation
‚îî‚îÄ‚îÄ üóÇÔ∏è visualizer/              # Legacy files (preserved)
```

## üöÄ **Quick Start**

### **üñ±Ô∏è C√°ch d·ªÖ nh·∫•t - Ch·∫°y script t·ª± ƒë·ªông:**

**Windows:**
```bash
run.bat
```

**Linux/Mac:**
```bash
chmod +x run.sh
./run.sh
```

Script s·∫Ω t·ª± ƒë·ªông:
- ‚úÖ Ki·ªÉm tra dependencies
- ‚úÖ T·∫°o virtual environment
- ‚úÖ C√†i ƒë·∫∑t packages
- ‚úÖ Kh·ªüi ƒë·ªông backend (port 5000)
- ‚úÖ Kh·ªüi ƒë·ªông frontend (port 8080)
- ‚úÖ M·ªü browser t·ª± ƒë·ªông

### **üîß C√°ch th·ªß c√¥ng:**

**1. Backend Setup:**
```bash
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
python app.py
```

**2. Frontend Setup:**
```bash
cd frontend
# Option 1: Node.js http-server
npx http-server -p 8080 --cors

# Option 2: Python simple server
python -m http.server 8080

# Option 3: VS Code Live Server
# Right-click index.html ‚Üí "Open with Live Server"
```

**3. Access:**
- üñ•Ô∏è Frontend: `http://localhost:8080`
- ‚öôÔ∏è Backend API: `http://localhost:5000`

## ‚ú® **T√≠nh nƒÉng m·ªõi:**

### **üîÑ API-First Architecture:**
- ‚úÖ RESTful API communication
- ‚úÖ Real-time status monitoring
- ‚úÖ Async/await error handling
- ‚úÖ Health check endpoints

### **üé® Modern UI/UX:**
- ‚úÖ Responsive design
- ‚úÖ Toast notifications
- ‚úÖ Loading states with progress
- ‚úÖ Interactive feedback
- ‚úÖ Keyboard shortcuts (Ctrl+1,2,3)

### **üìä Enhanced Visualization:**
- ‚úÖ Vertical timeline sidebar
- ‚úÖ Progress bars for time windows
- ‚úÖ Interactive route segments
- ‚úÖ Real-time map updates

### **‚ö° Performance Improvements:**
- ‚úÖ Route caching system
- ‚úÖ Lazy loading components
- ‚úÖ Optimized API calls
- ‚úÖ Memory management

## üìà **L·ª£i √≠ch c·ªßa ki·∫øn tr√∫c m·ªõi:**

### **üîß Development:**
- ‚úÖ **Separation of Concerns:** Frontend/Backend t√°ch bi·ªát
- ‚úÖ **Maintainability:** Code d·ªÖ b·∫£o tr√¨ v√† m·ªü r·ªông
- ‚úÖ **Scalability:** C√≥ th·ªÉ scale Frontend/Backend ri√™ng bi·ªát
- ‚úÖ **Testing:** Test API v√† UI ri√™ng l·∫ª

### **üé® User Experience:**
- ‚úÖ **Responsive:** Works on desktop, tablet, mobile
- ‚úÖ **Real-time feedback:** Progress indicators v√† status
- ‚úÖ **Error handling:** User-friendly error messages
- ‚úÖ **Performance:** Faster loading v√† smooth interactions

### **üöÄ Deployment:**
- ‚úÖ **Flexible hosting:** Frontend/Backend c√≥ th·ªÉ host ri√™ng
- ‚úÖ **CDN support:** Static assets c√≥ th·ªÉ d√πng CDN
- ‚úÖ **Container ready:** Easy Docker deployment
- ‚úÖ **Environment configs:** Dev/staging/production environments

---

## üìã **Legacy Documentation (Original)**

D·ª± √°n n√†y cung c·∫•p m·ªôt b·ªô gi·∫£i ho√†n ch·ªânh cho b√†i to√°n PDPTW (Pickup and Delivery Problem with Time Windows) s·ª≠ d·ª•ng c√°c thu·∫≠t to√°n t·ªëi ∆∞u h√≥a kh√°c nhau nh∆∞ ACO (Ant Colony Optimization), Greedy Insertion, v√† ph∆∞∆°ng ph√°p k·∫øt h·ª£p Hybrid ACO-Greedy.
cd visualizer

# C√†i ƒë·∫∑t dependencies
npm install

# Kh·ªüi ch·∫°y server
npm start
```

Server s·∫Ω ch·∫°y t·∫°i `http://localhost:3000`

### 2. C√†i ƒë·∫∑t Python dependencies (cho OR-Tools v√† Validator)

```bash
# C√†i ƒë·∫∑t OR-Tools
pip install ortools

# Kh√¥ng c·∫ßn c√†i ƒë·∫∑t g√¨ th√™m cho validator (ch·ªâ c·∫ßn Python thu·∫ßn)
```

## S·ª≠ d·ª•ng

### 1. Ch·∫°y Solver t·ª´ Command Line

#### ACO Solver:
```bash
cd RELEASE
PDPTW_ACO.exe input_file.txt output_file.txt
```

#### Greedy Insertion Solver:
```bash
cd RELEASE
PDPTW_GREEDY_INSERTION.exe input_file.txt output_file.txt
```

#### Hybrid ACO-Greedy Solver (Khuy·∫øn ngh·ªã):
```bash
cd RELEASE
PDPTW_HYBRID_ACO_GREEDY_V3.exe input_file.txt output_file.txt
```

#### OR-Tools Solver:
```bash
cd RELEASE
python PDPTW_ORTOOLS.py input_file.txt output_file.txt
```

### 2. ƒê·ªãnh d·∫°ng Input File

Format c·ªßa file input (.txt):
```
NAME: instance_name
LOCATION: city_name
COMMENT: description
TYPE: PDPTW
SIZE: number_of_nodes
CAPACITY: vehicle_capacity
NODES (INDEX X Y DEMAND PICKUP/DELIVERY PAIR SERVICE_TIME TIME_WINDOW_START TIME_WINDOW_END):
0 50.0 50.0 0 0 0 0 0 1440
1 10.0 20.0 1 1 11 10 0 200
...
```

### 3. ƒê·ªãnh d·∫°ng Output File

Format c·ªßa file solution (.txt):
```
Instance: instance_name
Best solution cost: total_cost
Number of routes: route_count
Route 1: 0 -> 1 -> 11 -> 0
Route 2: 0 -> 2 -> 12 -> 0
...
```

## Visualizer

Visualizer cung c·∫•p giao di·ªán web t∆∞∆°ng t√°c ƒë·ªÉ:

### T√≠nh nƒÉng ch√≠nh:
- **Load Instance**: T·∫£i instance t·ª´ file ho·∫∑c nh·∫≠p tr·ª±c ti·∫øp
- **Solve Online**: Gi·∫£i b√†i to√°n tr·ª±c ti·∫øp tr√™n web
- **Visualize Solution**: Hi·ªÉn th·ªã k·∫øt qu·∫£ tr√™n b·∫£n ƒë·ªì
- **Route Analysis**: Ph√¢n t√≠ch chi ti·∫øt t·ª´ng route

### C√°ch s·ª≠ d·ª•ng:

1. **Kh·ªüi ch·∫°y visualizer**:
   ```bash
   cd visualizer
   npm start
   ```

2. **Truy c·∫≠p**: M·ªü browser v√† v√†o `http://localhost:3000`

3. **Load Instance**:
   - Click "Load Instance File" ƒë·ªÉ t·∫£i t·ª´ file
   - Ho·∫∑c paste n·ªôi dung v√†o textarea
   - Ho·∫∑c click "Load v√≠ d·ª•" ƒë·ªÉ th·ª≠ v·ªõi d·ªØ li·ªáu m·∫´u

4. **Gi·∫£i b√†i to√°n**:
   - Click "Gi·∫£i b√†i to√°n" ƒë·ªÉ solver t·ª± ƒë·ªông
   - K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã tr√™n b·∫£n ƒë·ªì


##  Validator

Validator ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ ki·ªÉm tra t√≠nh h·ª£p l·ªá c·ªßa solution.

### C√°ch s·ª≠ d·ª•ng:

```bash
cd validator
python validator.py instance_file.txt solution_file.txt
```

### V√≠ d·ª•:
```bash
cd validator
python validator.py ../dataset/Instances/n100/bar-n100-1.txt ../dataset/Solutions/n100/bar-n100-1.6_733.txt
```

### Validator s·∫Ω ki·ªÉm tra:
- **Capacity constraints**: R√†ng bu·ªôc t·∫£i tr·ªçng xe
- **Time window constraints**: R√†ng bu·ªôc c·ª≠a s·ªï th·ªùi gian
- **Pickup-Delivery pairing**: R√†ng bu·ªôc c·∫∑p pickup-delivery
- **Route validity**: T√≠nh h·ª£p l·ªá c·ªßa route
- **Cost calculation**: T√≠nh to√°n cost ch√≠nh x√°c


## Dataset

Dataset bao g·ªìm c√°c test cases ƒë∆∞·ª£c chia theo quy m√¥:

### Instances:
- **n100/**: 100 nodes (nh·ªè) - Th√≠ch h·ª£p ƒë·ªÉ test nhanh
- **n200/**: 200 nodes (trung b√¨nh) - C√¢n b·∫±ng gi·ªØa t·ªëc ƒë·ªô v√† ƒë·ªô ph·ª©c t·∫°p  
- **n400/**: 400 nodes (l·ªõn) - Test hi·ªáu nƒÉng thu·∫≠t to√°n

## Thu·∫≠t to√°n

### 1. ACO (Ant Colony Optimization)
#### C√°ch ch·∫°y:
```powershell
cd RELEASE
.\PDPTW_ACO.exe input.txt output.txt
```

### 2. Greedy Insertion

#### C√°ch ch·∫°y:
```powershell
cd RELEASE
.\PDPTW_GREEDY_INSERTION.exe input.txt output.txt
```

### 3. Hybrid ACO-Greedy (Khuy·∫øn ngh·ªã)

#### C√°ch ch·∫°y:
```powershell
cd RELEASE
.\PDPTW_HYBRID_ACO_GREEDY_V3.exe input.txt output.txt
```

### 4. OR-Tools 

#### C√†i ƒë·∫∑t y√™u c·∫ßu:
```powershell
pip install ortools
```

#### C√°ch ch·∫°y:
```powershell
cd RELEASE
python PDPTW_ORTOOLS.py input.txt output.txt
```

